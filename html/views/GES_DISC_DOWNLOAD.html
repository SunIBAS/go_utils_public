<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="./../base.js?"></script>
    <style>
        .help p {
            font-size: 16px;
        }
    </style>
</head>
<body>
<template id="app">
    <div>
        <Modal v-model="showHelp" fullscreen :footer-hide="true" title="帮助">
            <div class="help">
                <p>下载 <a href="https://disc.gsfc.nasa.gov/datasets">GES DISC</a> 网站的遥感影像数据</p>
                <P>筛选数据</P>
                <img style="height: 320px" src="./../images/GES_DISC_SELECT.jpg" alt="">
                <P>进入选中的数据，点击右方的 <span style="color: #2db7f5">Online Archive</span></P>
                <img style="height: 320px" src="./../images/GES_DISC_ONLINE_ARCHIVE.jpg" alt="">
                <P>随机进入到某一年份的最底层，可以看到文件名和大小，这里进入了 <span style="color: #2db7f5">2003/011</span></P>
                <img style="height: 250px" src="./../images/GES_DISC_FILELIST.jpg" alt="">
                <p>文件的完整下载路径就是：<span style="color: #2196F3;">上方的链接+文件名</span></p>
                <p>例如 <span style="color: #2196F3;">https://hydro1.gesdisc.eosdis.nasa.gov/data/GLDAS/GLDAS_NOAH025_3H.2.1/2003/011/GLDAS_NOAH025_3H.A20030111.0000.021.nc4</span></p>
            </div>
        </Modal>
        <div style="padding: 10px;">
            <Row>
                <i-col span="4">链接：</i-col>
                <i-col span="20">
                    <i-input v-model="form.url"  placeholder="链接" :rows="15"/>
                </i-col>
            </Row><br/>
            <Row>
                <i-col span="4">开始时间：</i-col>
                <i-col span="20">
                    <i-input v-model="form.startTime"  placeholder="开始时间" :rows="15"/>
                </i-col>
            </Row><br/>
            <Row>
                <i-col span="4">结束时间：</i-col>
                <i-col span="20">
                    <i-input v-model="form.endTime"  placeholder="结束时间" :rows="15"/>
                </i-col>
            </Row><br/>
            <Row>
                <i-col span="4">文件名：</i-col>
                <i-col span="20">
                    <i-input v-model="form.filename"  placeholder="文件名" :rows="15"/>
                </i-col>
            </Row><br/>
            <Row v-for="(p,ind) in form.params" :key="ind" style="padding-bottom: 10px;">
                <i-col span="4">{{p.name}}</i-col>
                <i-col span="20">
                    <Tag v-for="(item,ind2) in p.vals" :key="item" :name="item" closable @on-close="handleClose(ind,ind2)">{{ item }}</Tag>
                    <i-button icon="ios-add" type="dashed" size="small" @click="handleAdd(ind)">添加标签</i-button>
                </i-col>
            </Row><br/>
            <Row>
                <i-col span="4"></i-col>
                <i-col span="20">
                    <i-button @click="addParams">添加变量</i-button>
                </i-col>
            </Row><br/>

            <Row>
                <i-col offset="4" span="20">
                    <i-button type="primary">提交</i-button>
                    <i-button type="info" @click="showHelp=true">查看帮助</i-button>
                </i-col>
            </Row>
        </div>
    </div>
</template>
</body>
<script>
    injectIviewCore(function () {
        new Vue({
            el: "#app",
            data: {
                showHelp: false,
                form: {
                    startTime: "2019-1-1",
                    endTime: "2019-12-31",
                    url: "",
                    filename: "",
                    paramsInd: 0,
                    params: [
                        // {
                        //     name: "",
                        //     vals: []
                        // }
                    ]
                }
            },
            methods: {
                addParams() {
                    this.form.params.push({
                        name: `param${this.form.paramsInd}`,
                        vals:[]
                    });
                    this.form.paramsInd++;
                },
                handleAdd(ind) {
                    let $this = this;
                    window.inputDialog(this,"",function (inp) {
                        inp.split(' ').forEach(i => {
                            if (!$this.form.params[ind].vals.includes(i)) {
                                $this.form.params[ind].vals.push(i);
                            }
                        });
                    },"","输入参数，多个用空格分开");
                },
                handleClose(ind1,ind2) {
                    this.form.params[ind1].vals.splice(ind2,1);
                }
            }
        });
    });
</script>
</html>